目标：在 10000 分时提供“无尽模式”选项，实现无缝切换、难度循环重置及 UI 增强。

## 一、界面与交互设计 (index.html & css/style.css)

1.  **改造全屏祝福弹窗 (`#newyear-overlay`)**：
    *   移除“再来一次”按钮。
    *   新增“继续挑战”按钮 (`#ny-continue-btn`)：
        *   设计：金色流光边框，体积较大，强调点击感。
        *   文案：“继续挑战 (开启无尽模式)”。
    *   保留“返回主菜单”按钮 (`#ny-menu-btn`)，文案调整为“见好就收 (返回菜单)”。
    *   支持键盘操作：Enter 键触发“继续”，Esc 键触发“返回”。

2.  **HUD 增强**：
    *   新增“无尽模式”徽章 (`.endless-badge`)：显示“∞ 无尽模式”。
    *   新增实时最高分显示 (`.highscore-small`)：在分数下方显示“历史最佳: XXXXX”。

## 二、游戏逻辑改造 (js/game.js)

1.  **状态管理**：
    *   新增标志位 `this.isEndless = false`。
    *   新增方法 `continueEndless()`：
        *   设置 `isEndless = true`。
        *   设置 `state = 'playing'`。
        *   隐藏 Overlay。
        *   记录首次进入无尽模式到 `localStorage` (`skyward_endless_first_time`)。
        *   **关键**：不重置分数，不清空平台。

2.  **核心循环 `update()` 调整**：
    *   修改 10000 分检测逻辑：若 `!this.isEndless` 且 `score > 10000`，才触发 Overlay。
    *   在无尽模式下，若分数超过历史最高分，实时更新本地存储和 HUD 显示。

3.  **难度重置与循环 (关键算法)**：
    *   在 `generatePlatform(y)` 中引入 `effectiveScore`（有效分数）概念。
    *   逻辑：`let effectiveScore = this.isEndless ? (this.score - 10000) % 10000 : this.score;`
    *   解释：进入无尽模式后，难度参数（平台宽度、移动概率、破碎概率）重置为 0 分时的状态，并随分数增长再次爬坡，每 10000 分一个循环，确保“永远可以玩下去”。

4.  **UI 绘制 `draw()`**：
    *   在 Canvas 上或通过 DOM 显示无尽模式特效（如分数颜色变为彩虹色，或背景增加流光）。

## 三、事件绑定 (js/main.js)

1.  **绑定新按钮**：
    *   `#ny-continue-btn` -> 调用 `game.continueEndless()`。
    *   `#ny-menu-btn` -> 返回主菜单（现有逻辑）。

2.  **键盘监听**：
    *   在 Overlay 激活时监听 `keydown`。

## 四、实施步骤

1.  **HTML/CSS**：更新 Overlay 按钮结构，添加 HUD 新元素，编写对应样式。
2.  **Game 类**：实现 `continueEndless`，修改 `update` 和 `generatePlatform`。
3.  **Main**：绑定事件，处理键盘输入。
4.  **验证**：
    *   模拟分数接近 10000 -> 触发弹窗。
    *   点击“继续” -> 弹窗关闭，游戏继续，难度肉眼可见变低（平台变宽）。
    *   点击“返回” -> 回到标题。
    *   死亡后 -> 结算界面正常显示最终高分。

## 五、交付物

*   修改后的 `index.html`, `css/style.css`, `js/game.js`, `js/main.js`。
*   功能验证测试。

