此计划旨在修复平台生成时可能出现的“极端跳跃”问题，即相邻平台水平距离过大导致无法接续。

## 1. 问题分析 (Diagnosis)
当前的生成逻辑 (在 `js/game.js` 的 `generatePlatform` 中) 虽然已经包含了一些约束，但仍可能存在漏洞，或者之前的修改引入了回归。
*   **疑似原因**:
    1.  `candidateCX` (候选中心点) 计算后的屏幕环绕逻辑 (`wrap`) 可能在某些边缘情况下导致位置突变。
    2.  `maxJumpDist` 参数可能设置得过大，或者随机偏移量 `offset` 的范围覆盖了无法触及的区域。
    3.  `if (x < 0) x = 0;` 和 `if (x + width > this.width) ...` 的硬性截断可能导致平台“吸附”在屏幕边缘，加剧了下一个平台的生成难度。

## 2. 修复方案 (Solution)
### 2.1 优化水平位置算法
*   **当前逻辑**: `lastCX + random(-200, 200)` -> `wrap` -> `clamp`。
*   **改进逻辑**:
    1.  **明确可达范围**: 基于角色的跳跃能力（物理参数），计算实际可达的最大水平距离。假设为 `MAX_REACHABLE_X`。
    2.  **避免极端环绕**: 只有当平台确实靠近边缘且玩家容易进行“穿屏”操作时，才生成对侧平台。否则应优先在同侧生成。
    3.  **平滑钳位**: 移除硬性的 `0` 和 `width` 截断，允许平台部分超出屏幕（只要能踩到），或者确保截断后的位置仍在可达范围内。

### 2.2 实施细节
*   修改 `generatePlatform` 方法：
    *   获取上一个平台的 `x` 和 `width`。
    *   计算新平台的 `x` 范围：`[lastX - MAX_DIST, lastX + MAX_DIST]`。
    *   处理屏幕边界：如果范围超出了 `0` 或 `width`，则根据“穿屏”规则决定是否折叠到另一侧。
    *   **关键约束**: 确保 `|newX - lastX|` (考虑穿屏距离) 始终 `<= MAX_JUMP_CAPABILITY`。

## 3. 测试验证 (Verification)
*   **测试用例**:
    *   连续生成 100 个平台，计算相邻两个平台的“有效距离”（考虑穿屏）。
    *   断言所有距离均小于 `MAX_JUMP_CAPABILITY`。

## 4. 交付物
*   修复后的 `js/game.js`。
